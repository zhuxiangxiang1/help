/*! YaoDian v1.5.0 2016/11/10 15:00 | (c) Yowant FED Team */
YD_user=function(){},YD_user.prototype={outTimeGo:function(a,e,s){function t(){0===o?window.location.href=a:(o--,setTimeout(function(){t()},1e3))}var o=e;s&&$.xbox.tips(s,1e3*(e+1)),t()}},YD_common=function(){},YD_common.prototype={loginCheck:function(a){$(".J_Status").on("click",function(){var a=$(this).find(".recharge-radio");a.hasClass("cur")?(a.removeClass("cur"),$(this).find("input").val("0")):(a.addClass("cur"),$(this).find("input").val("1"))}),$("#user").on("keyup",function(a){13===a.keyCode&&$("#pwd").focus()}),$("#pwd").on("keyup",function(a){13===a.keyCode&&$(".login-sub").click()}),$(".loginInput").on("click",function(){$(this).removeClass("error")}),$(".login-sub").on("click",function(){var e=$(this);if(e.hasClass("disabled"))return!1;var s=$("#user"),t=$("#pwd");if(""===s.val())$.xbox.tips("请输入登录名"),s.addClass("error");else if(""===t.val())$.xbox.tips("请输入密码"),t.addClass("error");else if(t.val().length<6)$.xbox.tips("请输入6-18位密码"),t.addClass("error");else{var o=$.md5($("#pwd").val());$("#J-pwd").val(o),e.addClass("disabled"),$.ajax({type:"post",url:a,data:$("#loginForm").serialize(),dataType:"json",success:function(a){1==a.status?window.location.href=a.url:2==a.userStatus?showStatus("提示信息",a.msg,a.status):($.xbox.tips(a.msg),$(".loginInput").addClass("error")),e.removeClass("disabled")},error:function(a){e.removeClass("disabled")}})}})},sendCode:function(a,e,s){function t(){0===o?($(a).html("重发验证码").removeClass("wait"),o=60):($(a).html(""+o+"后重新获取").addClass("wait"),o--,setTimeout(function(){new t},1e3))}a=a||"#send-code",e=e||"#phoneNum",s=s||"#authCode";var o=60;$(a).on("click",function(){if(!$(this).hasClass("wait")){var o=$(a).data("apiurl"),i=void 0!==$(a).data("chktelnum")&&0===parseInt($(a).data("chktelnum"))?0:1,r=$.trim($(e).val()),n=new YD_common,l=n.isMPhone(r);$.trim($(s).val());!l&&i?$.xbox.tips("请输入正确的手机号码"):$.ajax({type:"get",url:o,data:{phoneNum:r},dataType:"json",cache:!1,success:function(a){1==a.status?($.xbox.tips("验证码已发送到您的手机,请注意查收！"),t()):$.xbox.tips(a.failed)}})}})},setImgCode:function(){$("#changeVcode").on("click",function(){var a=$("#changeVcode").data("api-url");$.ajax({type:"get",url:a,data:{time:(new Date).getTime()},dataType:"json",success:function(a){1==a.status?$(".VCode").attr("src",a.img):$.xbox.tips(a.failed)}})}),$(".VCode").on("click",function(){$("#changeVcode").click()})},isMPhone:function(a){var e=/^0{0,1}(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])[0-9]{8}$/,s=!0;return""!==a&&e.test(a)||(s=!1),s},isIdCard:function(a){var e=/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/,s=!0;return e.test(a)||(s=!1),s},isemail:function(a){var e=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/,s=!0;return e.test(a)||(s=!1),s},findPwdStep2:function(a){$("#step2-sub").on("click",function(){var e=$("#phoneNum"),s=$("#send"),t=new YD_common,o=e.val(),i=t.isMPhone(o);i?""===s.val()||void 0===s.val()||s.val().length<6?$.xbox.tips("请输入验证码"):$.ajax({type:"post",url:a,data:$("#findPwdStep2").serialize(),dataType:"json",success:function(a){1==a.status?(new YD_user).outTimeGo(a.url,a.outTime,a.msg):$.xbox.tips(a.msg)}}):$.xbox.tips("请输入手机号码")})},findPwdStep1:function(a){$("#step1-sub").on("click",function(){var e=$("#user"),s=$("#send");""===e.val()||void 0===e.val()?$.xbox.tips("请输入平台帐号"):""===s.val()||void 0===s.val()?$.xbox.tips("请输入验证码"):$.ajax({type:"post",url:a,data:$("#findPwdStep1").serialize(),dataType:"json",success:function(a){1==a.status?(new YD_user).outTimeGo(a.url,a.outTime,a.msg):$.xbox.tips(a.msg)}})})},findPwdStep3:function(a){$("#step3-sub").on("click",function(){var e=$("#pwd1"),s=$("#pwd2");""===e.val()||void 0===e.val()||e.val().length<6?$.xbox.tips("请输入新密码"):""===s.val()||void 0===s.val()||s.val().length<6?$.xbox.tips("请输入第二次确认密码"):e.val()!=s.val()?$.xbox.tips("两次密码不相同"):($("#J-pwd").val($.md5(e.val())),$.ajax({type:"post",url:a,data:$("#findPwdStep3").serialize(),dataType:"json",success:function(a){1==a.status?(new YD_user).outTimeGo(a.url,a.outTime,a.msg):$.xbox.tips(a.msg)}}))})},checkFileType:function(a){var e=a.name,s=e.substring(e.lastIndexOf("."),e.length).toLowerCase(),t=!0;return".jpg"!=s&&".png"!=s&&".jpeg"!=s&&".gif"!=s&&(t=!1),t},upload:function(a,e,s){var t=this,o=s||"",i=$.trim($("#"+a).data("apiurl"));""!==i&&void 0!==i||$.xbox.tips("上传接口配置错误");var r=new plupload.Uploader({runtimes:"html5,html4",browse_button:a,dragdrop:!1,auto_start:!0,multi_selection:!1,url:i,flash_swf_url:BASE_PATH+"static/js/upload/Moxie.swf",filter:{max_file_size:t.MAX_UPLOAD,mime_types:[{title:"图片文件",extensions:"jpg,png,jpeg"}]},init:{Init:function(){""!==o?$("#"+a).text(o):$("#"+a).text("上传")},getInit:function(){},FilesAdded:function(a,e){plupload.each(e,function(e){return t.checkFileType(e)?(a.start(),!1):(a.removeFile(e),void $.xbox.tips("图片格式错误"))})},UploadProgress:function(a,e){},FileUploaded:function(a,s,t){var o=$.parseJSON(t.response);if(0===o.status)return $.xbox.tips(o.failed),!1;switch(e){case"idCardz":$("#upPic01").attr("src",o.url),$("#upPic01_val").val(o.url),$.xbox.tips("上传成功");break;case"idCard1":$("#idCard1").attr("src",o.url),$("#idCard1_src").val(o.url),$("#idCard1_src").next(".tips-r").show().removeClass("error").find("em").html(""),$.xbox.tips("上传成功");break;case"idCard2":$("#idCard2").attr("src",o.url),$("#idCard2_src").val(o.url),$("#idCard2_src").next(".tips-r").show().removeClass("error").find("em").html(""),$.xbox.tips("上传成功");break;default:$.xbox.tips("上传成功")}},Error:function(a,e){$.xbox.tips("上传失败")}}});r.init()},verification:function(a,e){function s(a){var e=!0,s=a.data("status"),t=a.parent().find(".tips-r"),o=a.attr("minlength"),i=a.attr("maxlength");if("idCard1_val"==a.attr("id")){var r=$("#idCard1_src").val();if(r&&r.length>0)return e=!0}if("idCard2_val"==a.attr("id")){var n=$("#idCard2_src").val();if(n&&n.length>0)return e=!0}if("idCard1_src"==a.attr("id")){var l=$("#idCard1_val").val();if(l&&l.length>0)return e=!0}if("idCard2_src"==a.attr("id")){var d=$("#idCard2_val").val();if(d&&d.length>0)return e=!0}""===a.val()||void 0===a.val()?(a.addClass("error"),void 0!==t.data("tips")&&""!==t.data("tips")?t.show().addClass("error").find("em").html(t.data("tips")):t.show().addClass("error").find("em").html("星标为必填项"),e=!1):o&&a.val().length<parseInt(o)?(a.addClass("error"),t.show().addClass("error").find("em").html(t.data("tips")),e=!1):i&&a.val().length>parseInt(i)?(a.addClass("error"),t.show().addClass("error").find("em").html(t.data("tips")),e=!1):void 0===s&&(a.removeClass("error"),t.show().removeClass("error").find("em").html(""),e=!0);var u="",c="",p="";switch(s){case"name":var v=$("#name").val(),m=/^[A-Za-z0-9_]{4,20}$/;m.test(v)?(a.removeClass("error"),t.show().removeClass("error").find("em").html("")):(a.addClass("error"),t.show().addClass("error").find("em").html(t.data("tips")),e=!1);break;case"pwd1":$("#pwd1").val().length<6?(a.addClass("error"),t.show().addClass("error").find("em").html(t.data("tips")),e=!1):(a.removeClass("error"),t.show().removeClass("error").find("em").html(""));break;case"pwd2":$("#pwd1").val()!==$("#pwd2").val()?(a.addClass("error"),t.show().addClass("error").find("em").html(t.data("tips")),e=!1):(a.removeClass("error"),t.show().removeClass("error").find("em").html(""),e=!0);break;case"idCard":u=new YD_common,c=a.val(),p=u.isIdCard(c),p?(a.removeClass("error"),t.show().removeClass("error").find("em").html("")):(a.addClass("error"),t.show().addClass("error").find("em").html(t.data("tips")),e=!1);break;case"Phone":u=new YD_common,c=a.val(),p=u.isMPhone(c),p?(a.removeClass("error"),t.show().removeClass("error").find("em").html("")):(a.addClass("error"),t.show().addClass("error").find("em").html(t.data("tips")),e=!1);break;case"email":u=new YD_common,isemail=a.val(),checkEmail=u.isemail(isemail),checkEmail?(a.removeClass("error"),t.show().removeClass("error").find("em").html(""),e=!0):(a.addClass("error"),t.show().addClass("error").find("em").html(t.data("tips")),e=!1);break;case"sendCode":var f=a.val();""===f||void 0===f||f.length<4?(a.addClass("error"),t.show().addClass("error").find("em").html(t.data("tips")),e=!1):(a.removeClass("error"),t.show().removeClass("error").find("em").html(""),e=!0)}return e}var t=$(".chackInput");t.on("focus",function(){$(this).addClass("focus")}),t.on("blur",function(){$(this).removeClass("focus"),s($(this))}),$("#v-sub").on("click",function(){var a=$(this);if(a.hasClass("disabled"))return!1;var e=!0;if(t.each(function(){e=e&&s($(this))}),!e)return!1;if(a.addClass("disabled"),$("#J-pwd").length>0){var o=$("#pwd1");$("#J-pwd").val($.md5(o.val()))}$("form").submit()}),$(".radio-a").on("click",function(){$(this).addClass("on").siblings().removeClass("on"),$(this).hasClass("accountStatus")?$("#accountStatus").val($(this).data("value")):$("#accountType").val($(this).data("value"))})},setPayPwd:function(a){$("#btnSubmit").on("click",function(){var e=$("#phoneNum"),s=$("#send"),t=$("#pwd1"),o=$("#pwd2"),i=new YD_common,r=e.val(),n=i.isMPhone(r),l=e.attr("disabled")||e.attr("readonly");l||n?""===s.val()||void 0===s.val()||s.val().length<4?$.xbox.tips("请输入正确的验证码"):""===t.val()||void 0===t.val()?$.xbox.tips("请输入6位支付密码"):6!=t.val().length?$.xbox.tips("请输入正确的支付密码"):""===o.val()||void 0===o.val()||6!=o.val().length?$.xbox.tips("请再次输入6位支付密码"):t.val()!=o.val()?$.xbox.tips("两次密码输入不一致"):($("#J-pwd").val($.md5(t.val())),$.ajax({type:"post",url:a,data:$("#frmPay").serialize(),dataType:"json",success:function(a){1==a.status?$(".popup-bg,.popup-sure").show():$.xbox.tips(a.msg)}})):$.xbox.tips("请输入手机号码")})},setPayPwd01:function(a){$("#setPayPwdStep1").on("click",function(){var e=$("#phoneNum"),s=$("#send"),t=new YD_common,o=e.val(),i=t.isMPhone(o);i?""===s.val()||void 0===s.val()||s.val().length<4?$.xbox.tips("请输入正确的验证码"):$.ajax({type:"post",url:a,data:$("#setPaypwd").serialize(),dataType:"json",success:function(a){1==a.status?window.location.href=a.url:$.xbox.tips(a.msg)}}):$.xbox.tips("请输入手机号码")})},setPayPwdStep02:function(a){$("#setPayPwdStep2").on("click",function(){var e=$("#pwd1"),s=$("#pwd2");""===e.val()||void 0===e.val()||6!=e.val().length?$.xbox.tips("请输入6位数字支付密码"):""===s.val()||void 0===s.val()||6!=s.val().length?$.xbox.tips("请再次输入6位数字支付密码"):e.val()!=s.val()?$.xbox.tips("两次密码输入不一致"):($("#J-pwd").val($.md5(e.val())),$.ajax({type:"post",url:a,data:$("#setPaypwd-step02").serialize(),dataType:"json",success:function(a){1==a.status?$(".popup-bg,.popup-sure").show():$.xbox.tips(a.msg)}}))}),$(".J_Close").on("click",function(){$(".popup-bg,.popup-sure").hide()})},setPhone:function(a,e){$("#btnSubmit").on("click",function(s){s.preventDefault();var t=$("#phoneNum"),o=$("#send"),i=new YD_common,r=t.val(),n=i.isMPhone(r);return 1!=e&&""==t.val()?($.xbox.tips("请输入手机号码"),!1):1==e||n?""===o.val()||void 0===o.val()?($.xbox.tips("请输入验证码"),!1):o.val().length<4?($.xbox.tips("请输入正确的验证码"),!1):void $.ajax({type:"POST",url:a,data:$("#relievePayPwd").serialize(),dataType:"json",success:function(a){1==a.status?1==e?window.location.href=a.url:(new YD_user).outTimeGo(a.url,a.outTime,a.msg):$.xbox.tips(a.msg)}}):($.xbox.tips("请输入正确的手机号码"),!1)})},changePwd:function(a){$("#changePwd").on("click",function(){var e=$.trim($("#oldPassword").val()),s=$.trim($("#newPassword").val()),t=$.trim($("#reNewPassword").val());return""===e||e.length<6||e.length>18?($.xbox.tips("请输入原始密码（6-18位）"),!1):""===s||s.length<6||s.length>18?($.xbox.tips("请输入新密码（6-18位）"),!1):""===t?($.xbox.tips("请输入确认密码"),!1):t!=s?($.xbox.tips("两次输入的密码不一致"),!1):($("#J-pwd-old").val($.md5(e)),$("#J-pwd-new").val($.md5(s)),$.ajax({type:"post",url:a,data:$("#resetLoginPwd").serialize(),async:!1,dataType:"json",success:function(a){return"1"!=a.status?($.xbox.tips(a.msg),!1):($(".popup-bg,.popup-sure").show(),void(new YD_user).outTimeGo(a.url,a.outTime))}}),void 0)})},setCookie:function(a,e){var s=7,t=new Date;t.setTime(t.getTime()+24*s*60*60*1e3),document.cookie=a+"="+escape(e)+";expires="+t.toGMTString()},getCookie:function(a){var e,s=new RegExp("(^| )"+a+"=([^;]*)(;|$)");return(e=document.cookie.match(s))?unescape(e[2]):""},delCookie:function(a){var e=new Date;e.setTime(e.getTime()-1);var s=getCookie(a);null!=s&&(document.cookie=a+"="+s+";expires="+e.toGMTString())}};