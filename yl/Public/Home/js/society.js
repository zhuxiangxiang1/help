/*! YaoDian v1.5.0 2016/11/10 15:00 | (c) Yowant FED Team */
var YW_Society=function(){};YW_Society.prototype={mainHeight:function(){},rebate:function(){function a(){var a=$('input[class="hbinput"]'),t=0,e=0;for(i=0;i<a.length;i++){var s=parseFloat($(a[i]).val())||0;t+=s,s>0&&e++}$("#total-num").html(t),$("#total-num").attr("data-total-num",t).attr("data-user-num",e)}a(),$(".hbinput").blur(function(){var t=parseFloat($(this).val())||0;$(this).val(t),a()}),$("#submitfrmSRebate").click(function(){a(),$(".J_PayMsg").html("").hide();var t=$("#total-num").attr("data-user-num"),e=$("#total-num").attr("data-total-num");if(e&&parseFloat(e)>0){var s='本次共划拨<span id="acc-num">'+t+'</span>个帐号， 划拨遥点合计<span id="pay-total">'+e+"</span>点";$(".J_PayMsg").html(s).show(),$(".popup-bg, #J_PopupPay").show()}else $.xbox.tips("请输入返点金额")}),this._initPayBox("#frmSRebate")},modouCopy:function(a){return""===a||void 0===a?(console.error("ZeroClipboard swfPath 未配置!"),!1):(ZeroClipboard.config({swfPath:a}),$(".J_BtnCopyGameId").each(function(a,t){var e=$(this).find(".J_HidGameId").val(),s=new ZeroClipboard($(t));s.on("copy",function(a){var t=a.clipboardData;t.setData("text/plain",e),$.xbox.tips("帐号复制成功！")})}),void $(".J_BtnCopyGamePwd").each(function(a,t){var e=$(this).find(".J_HidGamePwd").val(),s=new ZeroClipboard($(t));s.on("copy",function(a){var t=a.clipboardData;t.setData("text/plain",e),$.xbox.tips("密码复制成功！")})}))},packageCopy:function(a){return""===a||void 0===a?("function"==typeof window.console&&console.error("ZeroClipboard swfPath 未配置!"),!1):(ZeroClipboard.config({swfPath:a}),void $(".J_BtnCopyUrl").each(function(a,t){if(!$(this).hasClass("disabled")){var e=$(this).find(".J_HidCopyUrl").val(),s=new ZeroClipboard(t);s.on("copy",function(a){var t=a.clipboardData;t.setData("text/plain",e),$.xbox.tips("下载地址复制成功！")})}}))},packageAdd:function(a,t){$(".popup-close").on("click",function(){$("body").css("overflow","auto"),$(".popup-box, .popup-bg").hide()}),this._chooseSource(),this._chooseChannel(a),this._chooseGame(t)},_chooseSource:function(){$("#addnew").on("click",function(){$("body").css("overflow","hidden"),$(".popup-bg, #pfselect").show(),$("#J-gamesSelectSubmit").html("打包"),$("#chselectBtn").addClass("disabled"),$("#J-chNum").html("0")}),$(".accountsType").on("click",function(){var a=$(this).find("input").val();$(".J_PTRadio").removeClass("cur"),$(this).find(".J_PTRadio").addClass("cur"),$("#J-sourceId").val(a)}),$("#pfselectBtn").on("click",function(){var a=$("#J-sourceId").val();"0"!==a?($("#pfselect").hide(),$("#J-searchInput").val(""),$(window).trigger("sourceSelected")):$.xbox.tips("请选择游戏平台",3e3)})},_chooseChannel:function(a){function t(){var a=$("#J_listCHS li label.checked"),t=a.length;$("#J-chNum").html(t),t>0?$("#chselectBtn").removeClass("disabled"):$("#chselectBtn").addClass("disabled");for(var e=[],s=[],o=0;o<t;o++){var i=$(a[o]).find("input");e.push(i.val()),s.push(i.data("chname"))}$("#J-cids").val(e),$("#J-chnames").val(s)}function e(a){o=1,s(),$("#J-chNum").html("0"),$("#J-chCount").html("0"),$("#chselectBtn").addClass("disabled")}function s(){var t=$("#J-sourceId").val(),e=$("#J-searchInput").val();$.ajax({url:a,type:"GET",async:!1,dataType:"html",cache:!1,data:{pageIndex:o,name:e,source:t},success:function(a){1===o?$("#J_listCHS").html(a):$("#J_listCHS").append(a),setTimeout(function(){$("#J-chCount").html($(".J-chCounter:last").val()),parseInt($(".J-hasNext:last").val())?($("#J-loadbar .loadbar_area").html("加载更多"),$("#J-loadbar").show()):$("#J-loadbar").hide()},500),o++}})}var o=1;$(window).on("sourceSelected",function(){o=1,s(),$(".popup-bg, #chSelect").show()}),$("#J_listCHS").on("click",".J_CheckBox",function(a){a.preventDefault(),$(this).hasClass("checked")?$(this).removeClass("checked").find(".icon_checkbox_new").removeClass("checked"):$(this).addClass("checked").find(".icon_checkbox_new").addClass("checked"),t()}),$("#J-loadbar").on("click",".loadbar_area",function(a){$("#J-loadbar .loadbar_area").html("正在加载"),s()}),$("#J-searchBtn").on("click",e),$("#J-searchInput").on("keyup",function(a){13===a.keyCode&&e(a)}),$("#chselectBtn").click(function(){if($(this).hasClass("disabled"))return!1;var a=$("#J-cids").val();""!==a?($("#chSelect").hide(),$("#J-gameSearchInput").val(""),$("#J-gameNum").html("0"),$("#J-gamesSelectSubmit").addClass("disabled"),$(window).trigger("channelSelected")):$.xbox.tips("请选择渠道")})},_chooseGame:function(a){function t(){var t=$("#J-sourceId").val(),e=$("#J-cids").val(),s=$("#J-chnames").val(),i=$("#J-gameSearchInput").val(),n=$("#J-gameIds").val();$.ajax({url:a,type:"GET",async:!1,dataType:"html",cache:!1,data:{pageIndex:o,name:i,source:t,cids:e,chnames:s,gameIds:n},success:function(a){1===o?$("#J_listGames").html(a):$("#J_listGames").append(a),setTimeout(function(){$("#J-gameCount").html($(".J-gameCounter:last").val()),parseInt($(".J-hasGameNext:last").val())?($("#J-gameloadbar .loadbar_area").html("加载更多"),$("#J-gameloadbar").show()):$("#J-gameloadbar").hide()},500),o++}})}function e(a){var e=parseInt($("#J-gamesSelectSubmit").data("status"));return 1===e?($.xbox.tips("正在打包，请等待完成后再操作！"),!1):($("#J-gameNum").html("0"),$("#J-gameCount").html("0"),$("#J-gamesSelectSubmit").addClass("disabled"),o=1,void t())}function s(){var a=$("#J_listGames li label.checked"),t=a.length;$("#J-gameNum").html(t),t>0?$("#J-gamesSelectSubmit").removeClass("disabled"):$("#J-gamesSelectSubmit").addClass("disabled");for(var e=[],s=[],o=0;o<t;o++){var i=$(a[o]).find("input");e.push(i.data("gamename")),s.push(i.val())}$("#J-games").val(e),$("#J-gameIds").val(s)}var o=1;$(window).on("channelSelected",function(){o=1,t(),$(".popup-bg, #J-gamesSelect").show()}),$("#J-gameSearchBtn").on("click",e),$("#J-gameSearchInput").on("keyup",function(a){13===a.keyCode&&e(a)}),$("#J_listGames").on("click",".J_CheckBox",function(a){a.preventDefault();var t=parseInt($("#J-gamesSelectSubmit").data("status"));return 1===t?($.xbox.tips("正在打包，请等待完成后再操作！"),!1):($(this).hasClass("checked")?$(this).removeClass("checked").find(".icon_checkbox_new").removeClass("checked"):$(this).addClass("checked").find(".icon_checkbox_new").addClass("checked"),void s())}),$("#J-gameloadbar").on("click",".loadbar_area",function(a){$("#J-gameloadbar .loadbar_area").html("正在加载"),t()}),$("#J-gamesSelectSubmit").click(function(a){var t=$(this);if(a.preventDefault(),$(this).hasClass("disabled"))return!1;var e=$(this).attr("data-apiurl"),s=$("#J-games").val();return""===s?($.xbox.tips("请选择游戏"),!1):($(this).html("打包中...").addClass("disabled").data("status","1"),void $.ajax({type:"GET",url:e,data:$("#frmPKG").serialize(),dataType:"json",cache:!1,success:function(a){1===a.status?($(".popup-box, .popup-bg").hide(),$(".J-msgbox .msg_img").removeClass("faild"),$(".J-msgbox .msg_img").removeClass("ok"),$(".J-msgbox .msg_title").html("提交成功"),$(".J-msgbox .msg_content").html("游戏包生成可能需要几分钟的时间！"),$(".J-btn_ok_new").unbind("click"),$(".J-btn_ok_new").on("click",function(){window.location.href=window.location.href})):($(".J-msgbox .msg_img").removeClass("ok"),$(".J-msgbox .msg_img").removeClass("faild"),$(".J-msgbox .msg_title").html("提交失败"),$(".J-msgbox .msg_content").html("请稍后再试！请稍后再试！"),$(".J-btn_ok_new").unbind("click"),$(".J-btn_ok_new").on("click",function(){$(".J-msgboxMask, .J-msgbox").hide()})),$(".J-msgboxMask, .J-msgbox").show(),t.html("打包").removeClass("disabled").data("status","0")},error:function(){$.xbox.tips("网络出错！请重试"),t.html("打包").removeClass("disabled").data("status","0")}}))})},toPackage:function(){function a(){var a=0,t=$(".J_CheckBox");$.each(t,function(e,s){if(t[e].checked)return a=1,!1}),a>0?$("#btnPackage").removeClass("disabled"):$("#btnPackage").addClass("disabled")}$("#tableGame").on("click","#selectAll",function(t){var e=$(".J_CheckBox"),s=0;if($(this).is(":checked"))for(s=0;s<e.length;s++)e[s].checked=!0;else for(s=0;s<e.length;s++)e[s].checked=!1;a()}),$("#tableGame").on("click",".J_CheckBox",function(t){t.preventDefault(),a()}),$("#btnPackage").on("click",function(a){if($(this).hasClass("disabled"))return a.preventDefault(),$.xbox.tips("请先选择要打包的游戏"),!1;for(var t=$(".J_CheckBox"),e="",s=0;s<t.length;s++)if(t[s].checked){var o=$(t[s]).val(),i=$(t[s]).attr("data-gamename");e=o+":"+i+","+e}$("#ids").val(e);var n=$(this).attr("data-apiurl");$.xbox.tips("打包请求提交中..."),$(this).addClass("disabled"),$.ajax({type:"get",url:n,data:$("form").serialize(),dataType:"json",cache:!1,success:function(a){$("#msgChannel, .popup-bg").show(),1==a.status?$(".J_Msg").html("<p>成功提交打包请求<p><p>打包大约需要30分钟时间，你可以去其它地方逛逛再回来。</p>"):$(".J_Msg").html("<p>"+a.msg+"</p>"),$(this).removeClass("disabled"),$("body").css("overflow","auto")},error:function(){$.xbox.tips("网络出错！请重试"),$(this).removeClass("disabled")}})}),$(".J_Close, #btnContinue").on("click",function(){$("#msgChannel, .popup-bg").hide(),$("body").css("overflow","auto"),$("#btnPackage").removeClass("disabled")})},getGames:function(a,t){function e(){var a=$("#frmPackage").serialize();a+="&pageIndex="+s,$.ajax({url:o,type:"get",async:!1,dataType:"html",data:a,cache:!1,success:function(a){$("#tableGame").append(a)}})}var s=1,o=$("#getMore").attr("data-api-url");e(),$("#getMore").on("click",function(){s++,e()})},setDiscount:function(){$(".J_Status").on("click",function(){$(".J_Status").find(".recharge-radio").removeClass("cur"),$(this).find(".recharge-radio").addClass("cur"),$(this).find("input")[0].checked=!0}),$("#discount").on("keyup",function(){var a=$(this).val(),t=/^-?\d+\.?\d{0,1}$/;t.test(a)||$(this).val("")}),$("#btnSubmit").on("click",function(){if($(this).hasClass("disabled"))return!1;var a=$("#discount").val();""!==a&&parseFloat(a)>99?$.xbox.tips("折扣设置过大"):""!==a&&parseFloat(a)<=0?$.xbox.tips("折扣应大于0"):($("#frmGameEdit").submit(),$(this).addClass("disabled"))})},batchPay:function(){$("#btnImport").on("click",function(){""===$(".showFileName").html()?$.xbox.tips("请上传excel表格"):$(".popup-bg, #J_PopupPay").show()}),this._initPayBox("#frmImport")},_initPayBox:function(a){var t=$(a);$(".J_Close").on("click",function(){$(".popup-bg").hide(),$(this).parents(".popup-box").hide(),$("#pwd").val("")}),$("#choosebtn").click(function(){if($(this).hasClass("disabled"))return!1;var a=$.trim($("#paypassword").val());return""===a||a.length<4?($.xbox.tips("请输入正确的支付密码"),!1):($(this).addClass("disabled"),$("#pwd").val($.md5(a)),t.submit(),void 0)})},delPlayer:function(a){function t(){$.ajax({url:a,type:"get",async:!1,dataType:"json",cache:!1,data:{id:e},success:function(a){return 1!==a.status?(showStatus("提示信息",a.msg,a.status),!1):void(window.location.href=a.url)}})}var e="";$(".J_DelPlayer").on("click",function(){var a=$(this).attr("data-player");e=$(this).attr("data-player-id"),$(".J_Msg").html("您确定要删除帐号"+a+"吗？"),$("#popupConfirm, .popup-bg").show()}),$(".J_BtnOK").on("click",function(){$("#popupConfirm, .popup-bg").hide(),t()}),$(".J_Close").on("click",function(){$("#popupConfirm, .popup-bg").hide()})},editPlayer:function(a){function t(){$.ajax({type:"get",url:a,data:$("#verification-1").serialize(),dataType:"json",success:function(a){1==a.status?showStatus("提示信息",a.msg,a.status,function(){window.location.href=a.url}):($.xbox.tips(a.msg),showStatus("提示信息",a.msg,a.status)),$("#v-sub").removeClass("disabled")},error:function(){$.xbox.tips("编辑失败，请重新编辑！"),$("#v-sub").removeClass("disabled")}})}$("#discount").on("keyup",function(){var a=$(this).val(),t=/^-?\d+\.?\d{0,1}$/;t.test(a)||$(this).val("")});var e=$(".chackInput");e.on("focus",function(){$(this).addClass("focus")}),e.on("blur",function(){$(this).removeClass("focus");var a=$(this).data("status"),t=$(this).next(".tips-r");return""===$(this).val()||void 0===$(this).val()?($(this).addClass("error"),t.show().addClass("error").find("em").html("星标为必填项"),!1):void(void 0===a&&($(this).removeClass("error"),t.show().removeClass("error").find("em").html("")))}),$("#v-sub").on("click",function(){if($(this).hasClass("disabled"))return!1;var a=$("#discount").val(),e=$("#qudao").val();""===a?$.xbox.tips("请输入充值折扣"):parseFloat(a)>99?$.xbox.tips("折扣设置过大"):parseFloat(a)<=0?$.xbox.tips("折扣应大于0"):e.length<=0?$.xbox.tips("请设置渠道名称"):(t(),$(this).addClass("disabled"))})},ydIdReg:function(){$("#selectRuler").on("change",function(a){"1"==$(this).val()?$(".J_Regular").show():$(".J_Regular").hide()}),$("#btnSubmit").on("click",function(){if($(this).hasClass("disabled"))return!1;var a=$.trim($("#gameNum").val()),t=$.trim($("#startNum").val()),e=$.trim($("#prefix").val()),s=$("#selectRuler").val(),o=/^[a-zA-Z][a-zA-Z0-9]*$/;if("1"==s){if(a.length<1)return $.xbox.tips("账号个数， 请输入10-100的数字"),!1;if(parseInt(a)<10||parseInt(a)>100)return $.xbox.tips("账号个数， 请输入10-100的数字"),!1;if(e.length<3)return $.xbox.tips("账号前缀，请输入至少3位字母或字母数字组合，以字母开头"),!1;if(!o.test(e))return $.xbox.tips("账号前缀，请输入至少3位字母或字母数字组合，以字母开头"),!1;if(t.length<3)return $.xbox.tips("起始数字，请输入至少3位数字"),!1}else{if(a.length<2)return $.xbox.tips("账号个数， 请输入10-100的数字"),!1;if(parseInt(a)<10||parseInt(a)>100)return $.xbox.tips("账号个数， 请输入10-100的数字"),!1}$(this).addClass("disabled"),$("form").submit()})}};